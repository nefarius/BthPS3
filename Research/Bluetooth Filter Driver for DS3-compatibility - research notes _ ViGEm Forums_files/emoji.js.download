define("emoji",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.init=r.strategy=r.search=r.table=r.buildEmoji=r.buster=r.base=void 0;var n=config.assetBaseUrl+"/plugins/nodebb-plugin-emoji";r.base=n;var t=config["cache-buster"];r.buster=t;function a(e,r){var a=":"+e.name+":";var i=r?" defer":"";if(e.image){return"<img\n      "+(r?"data-":"")+'src="'+n+"/emoji/"+e.pack+"/"+e.image+"?"+t+'"\n      class="not-responsive emoji emoji-'+e.pack+" emoji--"+e.name+" "+i+'"\n      title="'+a+'"\n      alt="'+e.character+'"\n    />'}return'<span\n    class="emoji-'+e.pack+" emoji--"+e.name+'"\n    title="'+a+'"\n  ><span>'+e.character+"</span></span>"}r.buildEmoji=a;r.strategy={match:/\B:([^\s\n:]+)$/,search:function(e,n){n(r.search(e.toLowerCase().replace(/[_-]/g,"")).slice(0,10))},index:1,replace:function(e){return":"+e.name+": "},template:function(e){return a(e)+" "+e.name},cache:true};var i;function o(a){i=i||Promise.all([new Promise(function(r,n){e(["fuzzysearch"],r,n)}),new Promise(function(r,n){e(["leven"],r,n)}),new Promise(function(r,n){e(["composer/formatting"],r,n)}),$.getJSON(n+"/emoji/table.json?"+t)]).then(function(n){var t=n[0],a=n[1],i=n[2],o=n[3];r.table=o;var s=Object.keys(r.table).map(function(e){var n=r.table[e];return{name:e,aliases:n.aliases,keywords:n.keywords,character:n.character,image:n.image,pack:n.pack}});function c(e,r){var n=r.length;for(var a=0;a<n;a+=1){if(t(e,r[a])){return r[a]}}return null}function u(e){function r(r,n){var t=n*(1+a(e,r));return r.startsWith(e)?t-2:t}return s.filter(function(n){if(t(e,n.name)){n.score=r(n.name,1);return true}var a=c(e,n.aliases);if(a){n.score=r(a,3);return true}var i=c(e,n.keywords);if(i){n.score=r(i,7);return true}return false}).sort(function(e,r){return e.score-r.score}).sort(function(r,n){var t=+r.name.startsWith(e);var a=+n.name.startsWith(e);return a-t})}r.search=u;i.addButtonDispatch("emoji-add-emoji",function(r,n,t,a){new Promise(function(r,n){e(["emoji-dialog"],r,n)}).then(function(e){var i=e.toggleForInsert;return i(r,n,t,a)})})}).catch(function(e){var r=Error("[[emoji:meta-load-failed]]");console.error(r);app.alertError(r);throw e});if(a){i.then(function(){return setTimeout(a,0)})}return i}r.init=o});
//# sourceMappingURL=emoji.js.map